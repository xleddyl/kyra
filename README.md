# Kyra

Open-source Postgres backend platform with autogenerated GraphQL

## Docker Setup

### Quick Start

1. Copy the example Docker Compose configuration:

   ```bash
   cp docker-compose.example.yml docker-compose.yml
   ```

2. Create the required directories:

   ```bash
   mkdir -p schema migrations seeds
   ```

3. Start the application:
   ```bash
   docker-compose up -d
   ```

The application will be available at:

- **Web Interface**: http://localhost:3000
- **GraphQL API**: http://localhost:4000

### Services

- **kyra**: Main application container running both backend and frontend
- **postgres**: PostgreSQL 17.4 database with health checks

### Environment Variables

- `DATABASE_URL`: PostgreSQL connection string (default: `postgresql://postgres:postgres@postgres:5432/postgres`)
- `DATABASE_SCHEMA_EXPOSE`: Schemas to expose in GraphQL (default: `api,auth,private,public`)

## Database Management

Kyra uses four key directories for database management:

### üìÅ `schema/`

Contains SQL schema definition files that define your database structure.

### üìÅ `migrations/`

Contains database migration files for schema changes over time.

### üìÅ `seeds/`

Contains SQL files to populate the database with initial or test data.

## CLI Commands

The Kyra CLI provides several database management commands:

- `kyra migrate [--name <name>] [--dry-run] [--schema <schema>]`: Generate migrations from schema changes
- `kyra apply`: Apply pending migrations to the database
- `kyra reset [--yes]`: Reset database with fresh schema, migrations, and seeds
- `kyra serve`: Start the application services

Those commands can be run using `docker compose exec kyra kyra`

## Development

### Project Structure

- `src/web/`: Nuxt.js frontend application
- `src/server/`: Node.js GraphQL backend
- `src/cli/`: Command-line interface for database management
- `src/types/`: Shared TypeScript types and GraphQL codegen

### Local Development

1. Install dependencies:

   ```bash
   yarn install
   ```

2. Set up environment variables:

   ```bash
   cp .env.example .env
   ```

3. Start development servers:
   ```bash
   yarn web dev    # Frontend (port 3000)
   yarn server dev # Backend (port 4000)
   ```
